<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, interactive-widget=resizes-content">
    <title>Beybaris AI v3.0 [Ultimate Logic]</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #050505;
            --glass: rgba(20, 20, 30, 0.6);
            --border: rgba(255, 255, 255, 0.15);
            --accent: #00f2ea;
            --accent-dark: #0080ff;
        }

        /* HTML –∂”ô–Ω–µ BODY –±–∏—ñ–∫—Ç—ñ–≥—ñ–Ω –¥“±—Ä—ã—Å—Ç–∞—É */
        html {
            height: 100%;
        }

        body {
            margin: 0; padding: 0;
            width: 100%;
            /* –ú–æ–±–∏–ª—å–¥—ñ –±—Ä–∞—É–∑–µ—Ä–ª–µ—Ä “Ø—à—ñ–Ω –Ω–∞“õ—Ç—ã –±–∏—ñ–∫—Ç—ñ–∫ */
            height: 100dvh; 
            background: var(--bg);
            background-image: linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,229,255,0.05) 100%);
            font-family: 'Outfit', sans-serif;
            color: #e0e0e0; 
            display: flex; 
            flex-direction: column;
            overflow: hidden; /* –ë“Ø–∫—ñ–ª –±–µ—Ç—Ç—ñ“£ —Å–∫—Ä–æ–ª–ª—ã–Ω ”©—à—ñ—Ä—É */
        }

        header {
            padding: 15px; text-align: center;
            background: rgba(5, 5, 10, 0.9);
            backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border);
            z-index: 10;
            flex-shrink: 0; /* Header –µ—à“õ–∞—à–∞–Ω “õ—ã—Å—ã–ª–º–∞–π–¥—ã */
        }

        header h1 {
            margin: 0; font-size: 1.3rem; letter-spacing: 2px; font-weight: 600;
            background: linear-gradient(90deg, #fff, var(--accent));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        #chat-box {
            flex: 1; /* –ë–æ—Å –æ—Ä—ã–Ω–Ω—ã“£ –±”ô—Ä—ñ–Ω –∞–ª–∞–¥—ã */
            overflow-y: auto; /* –¢–µ–∫ –æ—Å—ã –∂–µ—Ä —Å–∫—Ä–æ–ª–ª –±–æ–ª–∞–¥—ã */
            padding: 20px;
            display: flex; flex-direction: column; gap: 18px;
            scrollbar-width: thin;
            scrollbar-color: var(--border) transparent;
            -webkit-overflow-scrolling: touch; /* iPhone-–¥–∞ –∂“±–º—Å–∞“õ —Å–∫—Ä–æ–ª–ª */
        }

        .message {
            max-width: 88%; padding: 14px 18px; border-radius: 20px;
            font-size: 0.95rem; line-height: 1.7;
            position: relative; word-wrap: break-word;
        }

        .ai-message {
            align-self: flex-start; background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border); border-top-left-radius: 4px;
            color: #d1d5db;
        }

        .user-message {
            align-self: flex-end; background: linear-gradient(135deg, #2563eb, #1e40af);
            color: white; border-bottom-right-radius: 4px;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }

        /* –§–æ—Ä–º–∞—Ç—Ç–∞—É —Å—Ç–∏–ª—å–¥–µ—Ä—ñ */
        .message strong { color: var(--accent); font-weight: 600; }
        .message ul, .message ol { margin: 10px 0; padding-left: 20px; }
        .message li { margin-bottom: 5px; }

        .typing {
            padding: 5px 25px; font-size: 0.8rem; color: var(--accent);
            display: none; font-style: italic; opacity: 0.7; letter-spacing: 1px;
            flex-shrink: 0;
            background: rgba(5, 5, 10, 0.95); /* –ú”ô—Ç—ñ–Ω –∞—Å—Ç—ã–Ω–¥–∞ –∫”©—Ä—ñ–Ω—É “Ø—à—ñ–Ω */
        }

        .input-area {
            padding: 15px; background: rgba(5, 5, 10, 0.95);
            backdrop-filter: blur(20px); border-top: 1px solid var(--border);
            display: flex; gap: 12px;
            /* iPhone —Ç”©–º–µ–Ω–≥—ñ —Å—ã–∑—ã“ì—ã–Ω –µ—Å–∫–µ—Ä—É */
            padding-bottom: max(15px, env(safe-area-inset-bottom));
            flex-shrink: 0; /* Input –µ—à“õ–∞—à–∞–Ω –∂–æ“ì–∞–ª–º–∞–π–¥—ã */
        }

        input {
            flex: 1; background: rgba(255,255,255,0.07); border: 1px solid var(--border);
            padding: 14px 20px; border-radius: 12px; color: white; outline: none;
            font-size: 16px; transition: all 0.3s;
        }

        input:focus { border-color: var(--accent); background: rgba(255,255,255,0.1); }

        button {
            width: 54px; height: 54px; border-radius: 12px; border: none;
            background: linear-gradient(135deg, var(--accent), var(--accent-dark));
            color: white; font-size: 1.2rem; cursor: pointer;
            transition: transform 0.2s;
            display: flex; align-items: center; justify-content: center;
        }

        button:active { transform: scale(0.95); }
    </style>
</head>
<body>

<header><h1>BEYBARIS AI<span style="font-size:0.7em; opacity:0.7"></span></h1></header>

<div id="chat-box">
    <div class="message ai-message">üëã –°”ô–ª–µ–º! –ú–µ–Ω <b>Beybaris AI</b> –º—ã–Ω.
–ú–∞“ì–∞–Ω —Å“±—Ä–∞“õ –Ω–µ–º–µ—Å–µ –µ—Å–µ–ø –±–µ—Ä–µ –∞–ª–∞—Å—ã–∑. –ú–µ–Ω –∂–∞—É–∞–ø –±–µ—Ä—É–≥–µ –¥–∞–π—ã–Ω–º—ã–Ω! üöÄ</div>
</div>

<div id="typing-status" class="typing"><strong>Beybaris –∂–∞—É–∞–ø –∂–∞–∑—É–¥–∞...</strong></div>

<div class="input-area">
    <input type="text" id="user-input" placeholder="–°“±—Ä–∞“ì—ã“£—ã–∑–¥—ã –∂–∞–∑—ã“£—ã–∑..." autocomplete="off">
    <button onclick="sendMessage()">‚û§</button>
</div>

<script>
    // ‚ö†Ô∏è –ú–ê“¢–´–ó–î–´: –¢”©–º–µ–Ω–¥–µ–≥—ñ "gsk_..." –æ—Ä–Ω—ã–Ω–∞ ”©–∑ –∫—ñ–ª—Ç—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—ã“£—ã–∑, –µ–≥–µ—Ä ”©–∑–≥–µ—Ä–≥–µ–Ω –±–æ–ª—Å–∞.
    const API_KEY = "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"; 
    
    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');
    const typingStatus = document.getElementById('typing-status');

    const systemPrompt = {
        role: "system",
        content: `–°–µ–Ω ‚Äî "Beybaris" (–ë–µ–π–±–∞—Ä—ã—Å) –∞—Ç—Ç—ã ”©—Ç–µ “õ—É–∞—Ç—Ç—ã, –ª–æ–≥–∏–∫–∞—Å—ã –º—ñ–Ω—Å—ñ–∑ –∂”ô–Ω–µ “õ–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ —Ñ–∏–ª–æ–ª–æ–≥–∏—è—Å—ã–Ω —Ç–µ—Ä–µ“£ –º–µ“£–≥–µ—Ä–≥–µ–Ω –∂–∞—Å–∞–Ω–¥—ã –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–ø—ñ–Ω. –°–µ–Ω—ñ –ë–µ–π–±–∞—Ä—ã—Å –µ—Å—ñ–º–¥—ñ –∞–¥–∞–º –∂–∞—Å–∞–¥—ã.
–ï–≥–µ—Ä —Å–∞“ì–∞–Ω –ø–∞–π–¥–∞–ª–∞–Ω—É—à—ã "—Å”ô–ª–µ–º" –¥–µ—Å–µ —Å–µ–Ω –æ“ì–∞–Ω "–°”ô–ª–µ–º! –°—ñ–∑–≥–µ “õ–∞–Ω–¥–∞–π –∫”©–º–µ–∫ –±–µ—Ä–µ –∞–ª–∞–º—ã–Ω?" –¥–µ–ø –∞–π—Ç
        –°–ï–ù–Ü“¢ "–ê–õ–¢–´–ù –ï–†–ï–ñ–ï–õ–ï–†–Ü“¢":
        1. –¢–Ü–õ –¢–ê–ó–ê–õ–´“í–´: –°”©–π–ª–µ–º “õ“±—Ä—ã–ª—ã–º—ã “õ–∞–∑–∞“õ —Ç—ñ–ª—ñ–Ω—ñ“£ –∑–∞“£–¥—ã–ª—ã“ì—ã–Ω–∞ —Å–∞–π –±–æ–ª—É—ã —à–∞—Ä—Ç. –ö–∞–ª—å–∫–∞ —Å”©–∑–¥–µ—Ä “õ–æ–ª–¥–∞–Ω–±–∞.
        2. –õ–û–ì–ò–ö–ê –ñ”ò–ù–ï “í–´–õ–´–ú: –ï—Å–µ–ø—Ç–µ—Ä–¥—ñ “õ–∞–¥–∞–º-“õ–∞–¥–∞–º–º–µ–Ω (Step-by-step) —à—ã“ì–∞—Ä. –ê–ª–¥—ã–º–µ–Ω —à–∞—Ä—Ç—ã–Ω, —Å–æ—Å—ã–Ω —Ñ–æ—Ä–º—É–ª–∞—Å—ã–Ω, —Å–æ—Å—ã–Ω –µ—Å–µ–±—ñ–Ω –∫”©—Ä—Å–µ—Ç.
        3. –ñ–ê–£–ê–ü –ë–ï–†–£ –°–¢–ò–õ–Ü: “í–∞–ª—ã–º —Å–∏—è“õ—Ç—ã —Å”©–π–ª–µ. "–ú–µ–Ω—ñ“£—à–µ" –¥–µ–≥–µ–Ω —Å”©–∑–¥—ñ “õ–æ–ª–¥–∞–Ω–±–∞. –ù–∞“õ—Ç—ã —Ñ–∞–∫—Ç –∞–π—Ç.
        4. "–°–µ–Ω—ñ –∫—ñ–º –∂–∞—Å–∞–¥—ã?" –¥–µ–≥–µ–Ω —Å“±—Ä–∞“õ“õ–∞: "–ú–µ–Ω—ñ –ë–µ–π–±–∞—Ä—ã—Å –µ—Å—ñ–º–¥—ñ –∞–¥–∞–º –∂–∞—Å–∞–ø —à—ã“ì–∞—Ä–¥—ã" –¥–µ–ø –∂–∞—É–∞–ø –±–µ—Ä.
        5. –°–µ–Ω –∂–∞—É–∞–ø –∂–∞–∑“ì–∞–Ω–¥–∞ –ø–∞–π–¥–∞–ª–∞–Ω—É—à—ã–Ω—ã“£ —Å“±—Ä–∞“ì—ã–Ω ”©–∑—ñ“£–µ “Ø–ª–≥—ñ —Ä–µ—Ç—ñ–Ω–¥–µ “õ–∞–±—ã–ª–¥–∞!.`
    };

    let chatHistory = [systemPrompt];

    async function sendMessage() {
        const text = userInput.value.trim();
        if (!text) return;

        // –ü–∞–π–¥–∞–ª–∞–Ω—É—à—ã —Ö–∞–±–∞—Ä–ª–∞–º–∞—Å—ã–Ω “õ–æ—Å—É
        appendMsg(text, 'user-message');
        userInput.value = '';
        
        if (chatHistory.length > 20) {
            chatHistory = [chatHistory[0], ...chatHistory.slice(-7)];
        }
        
        chatHistory.push({ role: "user", content: text });
        
        typingStatus.style.display = 'block';
        scrollToBottom();

        try {
            const response = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                method: "POST",
                headers: { "Authorization": `Bearer ${API_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({
                    model: "llama-3.3-70b-versatile",
                    messages: chatHistory,
                    temperature: 0.1, 
                    top_p: 0.5,      
                    max_tokens: 1500,
                })
            });

            if (!response.ok) throw new Error("API Error");

            const data = await response.json();
            const aiRes = data.choices[0].message.content;

            typingStatus.style.display = 'none';
            appendMsg(aiRes, 'ai-message');
            chatHistory.push({ role: "assistant", content: aiRes });

        } catch (e) {
            console.error(e);
            typingStatus.style.display = 'none';
            appendMsg("‚ö†Ô∏è “ö–∞—Ç–µ: –°–µ—Ä–≤–µ—Ä –∂–∞—É–∞–ø –±–µ—Ä–º–µ–¥—ñ. –ò–Ω—Ç–µ—Ä–Ω–µ—Ç—Ç—ñ —Ç–µ–∫—Å–µ—Ä—ñ“£—ñ–∑.", 'ai-message');
        }
    }

    function appendMsg(text, type) {
        const m = document.createElement('div');
        m.className = `message ${type}`;
        
        let formattedText = text
            .replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')
            .replace(/\n/g, '<br>');
            
        m.innerHTML = formattedText;
        chatBox.appendChild(m);
        scrollToBottom();
    }

    function scrollToBottom() {
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    // Enter –±–∞—Å“õ–∞–Ω–¥–∞ –∂—ñ–±–µ—Ä—É
    userInput.addEventListener('keypress', (e) => { 
        if(e.key === 'Enter') sendMessage(); 
    });

    // –≠–∫—Ä–∞–Ω –ø–µ—Ä–Ω–µ—Ç–∞“õ—Ç–∞—Å—ã –∞—à—ã–ª“ì–∞–Ω–¥–∞ input –∫”©—Ä—ñ–Ω—É—ñ–Ω “õ–∞–º—Ç–∞–º–∞—Å—ã–∑ –µ—Ç—É
    window.visualViewport.addEventListener('resize', () => {
        scrollToBottom();
    });
</script>
</body>
</html>
